# ğŸ’ Fundamental Data Types

## æ•°æ®ç±»å‹å¤§å°

æ•°æ®ç±»å‹çš„å¤§å°å–å†³äºç¼–è¯‘å™¨å’Œè®¡ç®—æœºä½“ç³»ç»“æ„ï¼

C++ ä»…ä¿è¯æ¯ä¸ªåŸºæœ¬æ•°æ®ç±»å‹éƒ½å…·æœ‰æœ€å°å¤§å° ![1](https://bu.dusays.com/2022/11/26/6381d2545c3fa.png)

ä¸ºäº†è·å¾—æœ€å¤§çš„å…¼å®¹æ€§ï¼Œæ‚¨ä¸åº”å‡è®¾å˜é‡å¤§äºæŒ‡å®šçš„æœ€å°å¤§å°

```cpp
#include <iostream>

int main()
{
    std::cout << "bool:\t\t" << sizeof(bool) << " bytes\n";
    std::cout << "char:\t\t" << sizeof(char) << " bytes\n";
    std::cout << "wchar_t:\t" << sizeof(wchar_t) << " bytes\n";
    std::cout << "char16_t:\t" << sizeof(char16_t) << " bytes\n";
    std::cout << "char32_t:\t" << sizeof(char32_t) << " bytes\n";
    std::cout << "short:\t\t" << sizeof(short) << " bytes\n";
    std::cout << "int:\t\t" << sizeof(int) << " bytes\n";
    std::cout << "long:\t\t" << sizeof(long) << " bytes\n";
    std::cout << "long long:\t" << sizeof(long long) << " bytes\n";
    std::cout << "float:\t\t" << sizeof(float) << " bytes\n";
    std::cout << "double:\t\t" << sizeof(double) << " bytes\n";
    std::cout << "long double:\t" << sizeof(long double) << " bytes\n";

    return 0;
}
```

ä¸‹é¢æ˜¯æˆ‘çš„ x64 æœºå™¨çš„è¾“å‡ºï¼Œä½¿ç”¨ Clionï¼š

```
bool:           1 bytes
char:           1 bytes
wchar_t:        2 bytes
char16_t:       2 bytes
char32_t:       4 bytes
short:          2 bytes
int:            4 bytes
long:           4 bytes
long long:      8 bytes
float:          4 bytes
double:         8 bytes
long double:    16 bytes
```

å¦‚æœæ‚¨ä½¿ç”¨ä¸åŒç±»å‹çš„æœºå™¨æˆ–ä¸åŒçš„ç¼–è¯‘å™¨ï¼Œæ‚¨çš„ç»“æœå¯èƒ½ä¼šæœ‰æ‰€ä¸åŒã€‚è¯·æ³¨æ„ï¼Œæ‚¨ä¸èƒ½å¯¹ void ç±»å‹ä½¿ç”¨ sizeof è¿ç®—ç¬¦ï¼Œå› ä¸ºå®ƒæ²¡æœ‰å¤§å°ï¼ˆè¿™æ ·åšä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ï¼‰

## æ— ç¬¦å·æ•´æ•°å’Œæœ‰ç¬¦å·æ•´æ•°

æœ‰ç¬¦å·æ•´æ•°èŒƒå›´ï¼š ![1](https://bu.dusays.com/2022/11/26/6381d81f385fa.png)

æ— ç¬¦å·æ•´æ•°èŒƒå›´ï¼š ![1](https://bu.dusays.com/2022/11/26/6381d91f961eb.png)

å¦‚æœæ— ç¬¦å·æ•´æ•°è¶…å‡ºèŒƒå›´ï¼Œåˆ™å°†å…¶é™¤ä»¥å¤§äºè¯¥ç±»å‹çš„æœ€å¤§æ•°ï¼Œåªä¿ç•™ä½™æ•°

åœ¨ C++ çš„æ•°å­¦è¿ç®—ä¸­ï¼ˆä¾‹å¦‚ç®—æœ¯æˆ–æ¯”è¾ƒï¼‰ï¼Œå¦‚æœä½¿ç”¨ä¸€ä¸ªæœ‰ç¬¦å·æ•´æ•°å’Œä¸€ä¸ªæ— ç¬¦å·æ•´æ•°ï¼Œåˆ™**æœ‰ç¬¦å·æ•´æ•°å°†è½¬æ¢ä¸ºæ— ç¬¦å·æ•´æ•°**ã€‚å¹¶ä¸”æ— ç¬¦å·æ•´æ•°ä¸èƒ½å­˜å‚¨è´Ÿæ•°ï¼Œè¿™ä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±

åœ¨ä¿å­˜æ•´æ•°ï¼ˆç”šè‡³åº”è¯¥æ˜¯éè´Ÿçš„æ•´æ•°ï¼‰å’Œæ•°å­¦è¿ç®—æ—¶ï¼Œæœ‰ç¬¦å·æ•°ä¼˜äºæ— ç¬¦å·æ•°ã€‚é¿å…æ··åˆæœ‰ç¬¦å·å’Œæ— ç¬¦å·æ•°å­—

åœ¨ C++ ä¸­ä»ç„¶æœ‰ä¸€äº›æƒ…å†µå¿…é¡»ä½¿ç”¨æ— ç¬¦å·æ•°ï¼š

é¦–å…ˆï¼Œåœ¨å¤„ç†ä½æ“ä½œæ—¶é¦–é€‰æ— ç¬¦å·æ•°ã€‚å½“éœ€è¦æ˜ç¡®å®šä¹‰çš„ç¯ç»•è¡Œä¸ºæ—¶ï¼Œå®ƒä»¬ä¹Ÿå¾ˆæœ‰ç”¨ï¼ˆåœ¨æŸäº›ç®—æ³•ä¸­å¾ˆæœ‰ç”¨ï¼Œä¾‹å¦‚åŠ å¯†å’Œéšæœºæ•°ç”Ÿæˆï¼‰

å…¶æ¬¡ï¼Œæ— ç¬¦å·æ•°çš„ä½¿ç”¨åœ¨æŸäº›æƒ…å†µä¸‹ä»ç„¶æ˜¯ä¸å¯é¿å…çš„ï¼Œä¸»è¦æ˜¯é‚£äº›ä¸æ•°ç»„ç´¢å¼•æœ‰å…³çš„æƒ…å†µã€‚ã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œæ— ç¬¦å·å€¼å¯ä»¥è½¬æ¢ä¸ºæœ‰ç¬¦å·å€¼

## å›ºå®šå®½åº¦æ•´æ•°å’Œ size\_t

### Fixed-width æ•´æ•°

ä¸ºä»€ä¹ˆæ•´æ•°å˜é‡çš„å¤§å°ä¸å›ºå®šï¼Ÿ

è¿™å¯ä»¥è¿½æº¯åˆ° Cï¼Œå½“æ—¶è®¡ç®—æœºé€Ÿåº¦å¾ˆæ…¢ï¼Œæ€§èƒ½æ˜¯æœ€å—å…³æ³¨çš„é—®é¢˜ã€‚ C é€‰æ‹©æœ‰æ„ä¿ç•™æ•´æ•°çš„å¤§å°ï¼Œä»¥ä¾¿ç¼–è¯‘å™¨å®ç°è€…å¯ä»¥é€‰æ‹©åœ¨ç›®æ ‡è®¡ç®—æœºä½“ç³»ç»“æ„ä¸Šè¡¨ç°æœ€ä½³çš„ int å¤§å°

C99 å®šä¹‰äº†ä¸€ç»„å›ºå®šå®½åº¦çš„æ•´æ•°ï¼ˆåœ¨ stdint.h å¤´æ–‡ä»¶ä¸­ï¼‰ï¼Œä¿è¯åœ¨ä»»ä½•ä½“ç³»ç»“æ„ä¸Šéƒ½å…·æœ‰ç›¸åŒçš„å¤§å°

C++ æ­£å¼é‡‡ç”¨è¿™äº›å›ºå®šå®½åº¦æ•´æ•°ä½œä¸º C++11 çš„ä¸€éƒ¨åˆ†ã€‚å¯ä»¥é€šè¿‡åŒ…å« `<cstdint>` å¤´æ–‡ä»¶æ¥è®¿é—®å®ƒä»¬ï¼Œå®ƒä»¬åœ¨ std å‘½åç©ºé—´å†…å®šä¹‰

![1](https://bu.dusays.com/2022/11/26/6381dcb67d0e0.png)

### Fast and least æ•´æ•°

The fast ç±»å‹ï¼ˆ`std::int_fast#_t` å’Œ `std::uint_fast#_t`ï¼‰æä¾›æœ€å¿«çš„æœ‰ç¬¦å·/æ— ç¬¦å·æ•´æ•°ç±»å‹ï¼Œå®½åº¦è‡³å°‘ä¸º # ä½ï¼ˆå…¶ä¸­ # = 8ã€16ã€32 æˆ– 64ï¼‰ã€‚ä¾‹å¦‚ï¼Œ`std::int_fast32_t` å°†ä¸ºæ‚¨æä¾›æœ€å¿«çš„è‡³å°‘ 32 ä½çš„æœ‰ç¬¦å·æ•´æ•°ç±»å‹

The least ç±»å‹ï¼ˆ`std::int_least#_t` å’Œ `std::uint_least#_t`ï¼‰æä¾›å®½åº¦è‡³å°‘ä¸º # ä½ï¼ˆå…¶ä¸­ # = 8ã€16ã€32 æˆ– 64ï¼‰çš„æœ€å°æœ‰ç¬¦å·/æ— ç¬¦å·æ•´æ•°ç±»å‹ã€‚ä¾‹å¦‚ï¼Œ`std::uint_least32_t` å°†ä¸ºæ‚¨æä¾›è‡³å°‘ 32 ä½çš„æœ€å°æ— ç¬¦å·æ•´æ•°ç±»å‹

ç¤ºä¾‹ï¼š

```cpp
#include <cstdint> // for fixed-width integers
#include <iostream>

int main()
{
	std::cout << "least 8:  " << sizeof(std::int_least8_t) * 8 << " bits\n";
	std::cout << "least 16: " << sizeof(std::int_least16_t) * 8 << " bits\n";
	std::cout << "least 32: " << sizeof(std::int_least32_t) * 8 << " bits\n";
	std::cout << '\n';
	std::cout << "fast 8:  " << sizeof(std::int_fast8_t) * 8 << " bits\n";
	std::cout << "fast 16: " << sizeof(std::int_fast16_t) * 8 << " bits\n";
	std::cout << "fast 32: " << sizeof(std::int_fast32_t) * 8 << " bits\n";

	return 0;
}
```

Resultï¼š

```
least 8:  8 bits
least 16: 16 bits
least 32: 32 bits

fast 8:  8 bits
fast 16: 16 bits
fast 32: 32 bits
```

ç„¶è€Œï¼Œè¿™äº›å¿«é€Ÿä¸”æœ€å°çš„æ•´æ•°æœ‰å…¶è‡ªèº«çš„ç¼ºç‚¹ï¼šé¦–å…ˆï¼ŒçœŸæ­£ä½¿ç”¨å®ƒä»¬çš„ç¨‹åºå‘˜å¹¶ä¸å¤šï¼Œä¸ç†Ÿæ‚‰ä¼šå¯¼è‡´é”™è¯¯ã€‚å…¶æ¬¡ï¼Œå¿«é€Ÿç±»å‹ä¼šå¯¼è‡´ä¸æˆ‘ä»¬åœ¨ 4 å­—èŠ‚æ•´æ•°ä¸­çœ‹åˆ°çš„ç›¸åŒç±»å‹çš„å†…å­˜æµªè´¹ã€‚æœ€ä¸¥é‡çš„æ˜¯ï¼Œç”±äºå¿«é€Ÿ/æœ€å°æ•´æ•°çš„å¤§å°å¯èƒ½ä¼šæœ‰æ‰€ä¸åŒï¼Œå› æ­¤æ‚¨çš„ç¨‹åºå¯èƒ½ä¼šåœ¨è§£æä¸ºä¸åŒå¤§å°çš„æ¶æ„ä¸Šè¡¨ç°å‡ºä¸åŒçš„è¡Œä¸º

### std::int8\_t å’Œ std::uint8\_t å¯èƒ½è¡¨ç°å¾—åƒå­—ç¬¦è€Œä¸æ˜¯æ•´æ•°

ç”±äº C++ è§„èŒƒä¸­çš„ç–å¿½ï¼Œå¤§å¤šæ•°ç¼–è¯‘å™¨åˆ†åˆ«å°† std::int8\_t å’Œ std::uint8\_tï¼ˆä»¥åŠç›¸åº”çš„å¿«é€Ÿå’Œæœ€å°å›ºå®šå®½åº¦ç±»å‹ï¼‰å®šä¹‰ä¸º signed char å’Œ unsigned char ç±»å‹ï¼Œå¹¶å°†å…¶è§†ä¸ºç›¸åŒçš„ç±»å‹ã€‚è¿™æ„å‘³ç€è¿™äº› 8 ä½ç±»å‹çš„è¡Œä¸ºå¯èƒ½ï¼ˆæˆ–å¯èƒ½ä¸ï¼‰ä¸å…¶ä»–å›ºå®šå®½åº¦ç±»å‹ä¸åŒï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´é”™è¯¯ã€‚æ­¤è¡Œä¸ºæ˜¯ç³»ç»Ÿç›¸å…³çš„ï¼Œå› æ­¤åœ¨ä¸€ç§ä½“ç³»ç»“æ„ä¸Šæ­£ç¡®è¿è¡Œçš„ç¨‹åºå¯èƒ½æ— æ³•ç¼–è¯‘æˆ–åœ¨å¦ä¸€ç§ä½“ç³»ç»“æ„ä¸Šæ­£ç¡®è¿è¡Œ

ä¸ºäº†ä¿æŒä¸€è‡´æ€§ï¼Œæœ€å¥½å®Œå…¨é¿å…ä½¿ç”¨ std::int8\_t å’Œ std::uint8\_tï¼ˆä»¥åŠç›¸å…³çš„å¿«é€Ÿå’Œæœ€å°‘ç±»å‹ï¼‰ï¼ˆæ”¹ç”¨ std::int16\_t æˆ– std::uint16\_tï¼‰

8 ä½å›ºå®šå®½åº¦æ•´æ•°ç±»å‹é€šå¸¸è¢«è§†ä¸ºå­—ç¬¦è€Œä¸æ˜¯æ•´æ•°å€¼ï¼ˆè¿™å¯èƒ½å› ç³»ç»Ÿè€Œå¼‚ï¼‰ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹é¦–é€‰ 16 ä½å›ºå®šæ•´æ•°ç±»å‹

### Best practice

æˆ‘ä»¬çš„ç«‹åœºæ˜¯æ­£ç¡®æ¯”å¿«é€Ÿæ›´å¥½ï¼Œåœ¨ç¼–è¯‘æ—¶å¤±è´¥æ¯”è¿è¡Œæ—¶æ›´å¥½â€”â€”å› æ­¤ï¼Œæˆ‘ä»¬å»ºè®®é¿å…ä½¿ç”¨å¿«é€Ÿ/æœ€å°‘çš„ç±»å‹ï¼Œè€Œä½¿ç”¨å›ºå®šå®½åº¦çš„ç±»å‹ã€‚å¦‚æœæ‚¨åæ¥å‘ç°éœ€è¦æ”¯æŒæ— æ³•ç¼–è¯‘å›ºå®šå®½åº¦ç±»å‹çš„å¹³å°ï¼Œé‚£ä¹ˆæ‚¨å¯ä»¥åœ¨æ­¤æ—¶å†³å®šå¦‚ä½•è¿ç§»æ‚¨çš„ç¨‹åºï¼ˆå¹¶å½»åº•æµ‹è¯•ï¼‰

1. å½“æ•´æ•°çš„å¤§å°æ— å…³ç´§è¦æ—¶ï¼Œé¦–é€‰ intï¼ˆä¾‹å¦‚ï¼Œæ•°å­—å°†å§‹ç»ˆé€‚åˆ 2 å­—èŠ‚æœ‰ç¬¦å·æ•´æ•°çš„èŒƒå›´ï¼‰ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨è¦æ±‚ç”¨æˆ·è¾“å…¥ä»–ä»¬çš„å¹´é¾„ï¼Œæˆ–è€…ä» 1 æ•°åˆ° 10ï¼Œåˆ™ int æ˜¯ 16 ä½è¿˜æ˜¯ 32 ä½éƒ½æ²¡æœ‰å…³ç³»ï¼ˆæ•°å­—å°†é€‚åˆä»»ä½•ä¸€ç§æ–¹å¼ï¼‰ã€‚è¿™å°†æ¶µç›–æ‚¨å¯èƒ½é‡åˆ°çš„ç»å¤§å¤šæ•°æƒ…å†µ
2. å­˜å‚¨éœ€è¦ä¿è¯èŒƒå›´çš„æ•°é‡æ—¶ï¼Œé¦–é€‰ `std::int#_t`
3. åœ¨è¿›è¡Œä½æ“ä½œæˆ–éœ€è¦æ˜ç¡®å®šä¹‰çš„ç¯ç»•è¡Œä¸ºæ—¶ï¼Œé¦–é€‰ `std::uint#_t`
4. å°½å¯èƒ½é¿å…ä»¥ä¸‹æƒ…å†µï¼š
   1. å­˜å‚¨æ•°é‡çš„æ— ç¬¦å·ç±»å‹
   2. 8 ä½å›ºå®šå®½åº¦æ•´æ•°ç±»å‹
   3. Fast and least æ•´æ•°ç±»å‹
   4. ä»»ä½•ç‰¹å®šäºç¼–è¯‘å™¨çš„å›ºå®šå®½åº¦æ•´æ•°â€”â€”ä¾‹å¦‚ï¼ŒVisual Studio å®šä¹‰äº† `__int8`ã€`__int16` â€¦â€¦

### size\_t

sizeofï¼ˆä»¥åŠè®¸å¤šè¿”å›å¤§å°æˆ–é•¿åº¦å€¼çš„å‡½æ•°ï¼‰è¿”å›ä¸€ä¸ª std::size\_t ç±»å‹çš„å€¼ã€‚ std::size\_t è¢«å®šä¹‰ä¸ºæ— ç¬¦å·æ•´æ•°ç±»å‹ï¼Œé€šå¸¸ç”¨äºè¡¨ç¤ºå¯¹è±¡çš„å¤§å°æˆ–é•¿åº¦

æœ‰è¶£çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ sizeof è¿ç®—ç¬¦ï¼ˆè¿”å› std::size\_t ç±»å‹çš„å€¼ï¼‰æ¥è¯¢é—® std::size\_t æœ¬èº«çš„å¤§å°ï¼š

```cpp
#include <cstddef> // std::size_t
#include <iostream>

int main()
{
	std::cout << sizeof(std::size_t) << '\n';

	return 0;
}
```

å°±åƒæ•´æ•°çš„å¤§å°ä¼šå› ç³»ç»Ÿè€Œå¼‚ä¸€æ ·ï¼Œstd::size\_t çš„å¤§å°ä¹Ÿä¼šæœ‰æ‰€ä¸åŒã€‚ std::size\_t ä¿è¯ä¸ºæ— ç¬¦å·ä¸”è‡³å°‘ä¸º 16 ä½ï¼Œä½†åœ¨å¤§å¤šæ•°ç³»ç»Ÿä¸Šå°†ç­‰åŒäºåº”ç”¨ç¨‹åºçš„åœ°å€å®½åº¦ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äº 32 ä½åº”ç”¨ç¨‹åºï¼Œstd::size\_t é€šå¸¸æ˜¯ 32 ä½æ— ç¬¦å·æ•´æ•°ï¼Œè€Œå¯¹äº 64 ä½åº”ç”¨ç¨‹åºï¼Œsize\_t é€šå¸¸æ˜¯ 64 ä½æ— ç¬¦å·æ•´æ•°ã€‚ size\_t è¢«å®šä¹‰ä¸ºè¶³å¤Ÿå¤§ä»¥å®¹çº³ç³»ç»Ÿä¸Šå¯åˆ›å»ºçš„æœ€å¤§å¯¹è±¡çš„å¤§å°ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚ä¾‹å¦‚ï¼Œå¦‚æœ std::size\_t ä¸º 4 å­—èŠ‚å®½ï¼Œåˆ™ç³»ç»Ÿä¸Šå¯åˆ›å»ºçš„æœ€å¤§å¯¹è±¡ä¸èƒ½å¤§äº 4,294,967,295 å­—èŠ‚ï¼Œå› ä¸º 4,294,967,295 æ˜¯ 4 å­—èŠ‚æ— ç¬¦å·æ•´æ•°å¯ä»¥å­˜å‚¨çš„æœ€å¤§æ•°å­—ã€‚è¿™åªæ˜¯å¯¹è±¡å¤§å°çš„ä¸Šé™ï¼Œå®é™…å¤§å°é™åˆ¶å¯èƒ½ä¼šæ›´ä½ï¼Œå…·ä½“å–å†³äºæ‚¨ä½¿ç”¨çš„ç¼–è¯‘å™¨

æ ¹æ®å®šä¹‰ï¼Œä»»ä½•å¤§å°ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰å¤§äº size\_t å¯ä»¥å®¹çº³çš„æœ€å¤§æ•´æ•°å€¼çš„å¯¹è±¡éƒ½è¢«è§†ä¸ºæ ¼å¼é”™è¯¯ï¼ˆå¹¶å°†å¯¼è‡´ç¼–è¯‘é”™è¯¯ï¼‰ï¼Œå› ä¸º sizeof è¿ç®—ç¬¦å°†æ— æ³•åœ¨ä¸ç¯ç»•çš„æƒ…å†µä¸‹è¿”å›å¤§å°

## æµ®ç‚¹æ•°ï¼ˆIEEE 754ï¼‰

### æµ®ç‚¹èŒƒå›´å’Œæµ®ç‚¹ç²¾åº¦

![1](https://bu.dusays.com/2022/11/26/63820f12cc479.png)

ä½¿ç”¨æµ®ç‚¹æ–‡å­—æ—¶ï¼Œå§‹ç»ˆè‡³å°‘åŒ…å«ä¸€ä½å°æ•°ï¼ˆå³ä½¿å°æ•°ä¸º 0ï¼‰ã€‚è¿™æœ‰åŠ©äºç¼–è¯‘å™¨ç†è§£è¯¥æ•°å­—æ˜¯æµ®ç‚¹æ•°è€Œä¸æ˜¯æ•´æ•°

```
int x{5}; // 5 means integer
double y{5.0}; // 5.0 is a floating point literal (no suffix means double type by default)
float z{5.0f}; // 5.0 is a floating point literal, f suffix means float type
```

å§‹ç»ˆç¡®ä¿å­—é¢é‡çš„ç±»å‹ä¸åˆ†é…ç»™å®ƒä»¬æˆ–ç”¨äºåˆå§‹åŒ–çš„å˜é‡çš„ç±»å‹ç›¸åŒ¹é…ã€‚å¦åˆ™ä¼šå¯¼è‡´ä¸å¿…è¦çš„è½¬æ¢ï¼Œå¯èƒ½ä¼šå¯¼è‡´ç²¾åº¦æŸå¤±

ç¡®ä¿åœ¨åº”è¯¥ä½¿ç”¨æµ®ç‚¹æ–‡å­—çš„åœ°æ–¹ä¸ä½¿ç”¨æ•´æ•°æ–‡å­—ã€‚è¿™åŒ…æ‹¬åˆå§‹åŒ–æµ®ç‚¹å¯¹è±¡æˆ–ä¸ºæµ®ç‚¹å¯¹è±¡èµ‹å€¼ã€è¿›è¡Œæµ®ç‚¹è¿ç®—ä»¥åŠè°ƒç”¨éœ€è¦æµ®ç‚¹å€¼çš„å‡½æ•°

![](https://bu.dusays.com/2022/11/26/6382110b7d067.png)

è¾“å‡ºæµ®ç‚¹æ•°æ—¶ï¼Œstd::cout çš„é»˜è®¤ç²¾åº¦ä¸º 6â€”â€”ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒå‡å®šæ‰€æœ‰æµ®ç‚¹å˜é‡ä»…å¯¹ 6 ä½æœ‰æ•ˆï¼ˆæµ®ç‚¹æ•°çš„æœ€å°ç²¾åº¦ï¼‰ï¼Œå› æ­¤å®ƒå°†æˆªæ–­ä¹‹åçš„ä»»ä½•å†…å®¹

æµ®ç‚¹å˜é‡çš„ç²¾åº¦ä½æ•°å–å†³äºå¤§å°ï¼ˆæµ®ç‚¹æ•°çš„ç²¾åº¦ä½äºåŒç²¾åº¦æ•°ï¼‰å’Œå­˜å‚¨çš„ç‰¹å®šå€¼ï¼ˆæŸäº›å€¼çš„ç²¾åº¦é«˜äºå…¶ä»–å€¼ï¼‰ã€‚æµ®ç‚¹å€¼çš„ç²¾åº¦åœ¨ 6 åˆ° 9 ä½ä¹‹é—´ï¼Œå¤§å¤šæ•°æµ®ç‚¹å€¼è‡³å°‘æœ‰ 7 ä½æœ‰æ•ˆæ•°å­—ã€‚åŒç²¾åº¦å€¼çš„ç²¾åº¦åœ¨ 15 åˆ° 18 ä½ä¹‹é—´ï¼Œå¤§å¤šæ•°åŒç²¾åº¦å€¼è‡³å°‘æœ‰ 16 ä½æœ‰æ•ˆæ•°å­—ã€‚ Long double çš„æœ€å°ç²¾åº¦ä¸º 15ã€18 æˆ– 33 ä½æœ‰æ•ˆæ•°å­—ï¼Œå…·ä½“å–å†³äºå®ƒå ç”¨çš„å­—èŠ‚æ•°

### èˆå…¥è¯¯å·®

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨åä¸º std::setprecision() çš„è¾“å‡ºæ“çºµå™¨å‡½æ•°è¦†ç›– std::cout æ˜¾ç¤ºçš„é»˜è®¤ç²¾åº¦ã€‚è¾“å‡ºæ“çºµå™¨æ”¹å˜æ•°æ®çš„è¾“å‡ºæ–¹å¼ï¼Œå¹¶åœ¨ iomanip æ ‡å¤´ä¸­å®šä¹‰

```
#include <iostream>
#include <iomanip> // for output manipulator std::setprecision()

int main()
{
    std::cout << std::setprecision(16); // show 16 digits of precision
    std::cout << 3.33333333333333333333333333333333333333f <<'\n'; // f suffix means float
    std::cout << 3.33333333333333333333333333333333333333 << '\n'; // no suffix means double

    return 0;
}
```

åœ¨ä½¿ç”¨éœ€è¦æ¯”å˜é‡æ‰€èƒ½å®¹çº³çš„ç²¾åº¦æ›´é«˜çš„æµ®ç‚¹æ•°æ—¶ï¼Œå¿…é¡»å°å¿ƒ

**é™¤éç©ºé—´éå¸¸å®è´µï¼Œå¦åˆ™æœ€å¥½ä½¿ç”¨ double over floatï¼Œå› ä¸º float ç¼ºä¹ç²¾åº¦é€šå¸¸ä¼šå¯¼è‡´ä¸å‡†ç¡®**

å€¼ 123456789.0 å…·æœ‰ 10 ä½æœ‰æ•ˆæ•°å­—ï¼Œä½†æµ®ç‚¹å€¼é€šå¸¸å…·æœ‰ 7 ä½ç²¾åº¦ï¼ˆè€Œ 123456792 çš„ç»“æœä»…ç²¾ç¡®åˆ° 7 ä½æœ‰æ•ˆæ•°å­—ï¼‰ã€‚æˆ‘ä»¬å¤±å»äº†ä¸€äº›ç²¾åº¦ï¼å½“ç”±äºæ— æ³•ç²¾ç¡®å­˜å‚¨æ•°å­—è€Œå¯¼è‡´ç²¾åº¦ä¸¢å¤±æ—¶ï¼Œè¿™ç§°ä¸º**èˆå…¥è¯¯å·®**

æ•°å­¦è¿ç®—ï¼ˆä¾‹å¦‚åŠ æ³•å’Œä¹˜æ³•ï¼‰å¾€å¾€ä¼šä½¿èˆå…¥è¯¯å·®å¢å¤§ã€‚æ‰€ä»¥å³ä½¿0.1åœ¨ç¬¬17ä½æœ‰æ•ˆä½æœ‰èˆå…¥è¯¯å·®ï¼Œä½†æ˜¯å½“æˆ‘ä»¬åŠ ä¸Š0.1åæ¬¡æ—¶ï¼Œèˆå…¥è¯¯å·®å·²ç»çˆ¬åˆ°ç¬¬16ä½æœ‰æ•ˆä½äº†ã€‚ç»§ç»­æ“ä½œä¼šå¯¼è‡´æ­¤é”™è¯¯å˜å¾—è¶Šæ¥è¶Šä¸¥é‡

### NaN å’Œ Inf

æœ‰ä¸¤ç§ç‰¹æ®Šç±»åˆ«çš„æµ®ç‚¹æ•°ã€‚ç¬¬ä¸€ä¸ªæ˜¯ `Inf`ï¼Œä»£è¡¨æ— ç©·å¤§ã€‚ Inf å¯ä»¥æ˜¯æ­£æ•°æˆ–è´Ÿæ•°ã€‚ç¬¬äºŒä¸ªæ˜¯ `NaN`ï¼Œä»£è¡¨â€œä¸æ˜¯æ•°å­—â€ã€‚æœ‰å‡ ç§ä¸åŒç±»å‹çš„ NaNï¼ˆæˆ‘ä»¬ä¸ä¼šåœ¨è¿™é‡Œè®¨è®ºï¼‰ã€‚ NaN å’Œ Inf ä»…åœ¨ç¼–è¯‘å™¨å¯¹æµ®ç‚¹æ•°ä½¿ç”¨ç‰¹å®šæ ¼å¼ (IEEE 754) æ—¶å¯ç”¨

### Conclusion

æ€»è€Œè¨€ä¹‹ï¼Œå…³äºæµ®ç‚¹æ•°ä½ åº”è¯¥è®°ä½ä¸¤ä»¶äº‹ï¼š

æµ®ç‚¹æ•°å¯¹äºå­˜å‚¨éå¸¸å¤§æˆ–éå¸¸å°çš„æ•°å­—å¾ˆæœ‰ç”¨ï¼ŒåŒ…æ‹¬å¸¦æœ‰å°æ•°éƒ¨åˆ†çš„æ•°å­—

æµ®ç‚¹æ•°é€šå¸¸æœ‰å°çš„èˆå…¥è¯¯å·®ï¼Œå³ä½¿æ•°å­—çš„æœ‰æ•ˆæ•°å­—å°‘äºç²¾åº¦ä¹Ÿæ˜¯å¦‚æ­¤ã€‚å¾ˆå¤šæ—¶å€™è¿™äº›éƒ½æ²¡æœ‰å¼•èµ·æ³¨æ„ï¼Œå› ä¸ºå®ƒä»¬å¤ªå°äº†ï¼Œè€Œä¸”å› ä¸ºè¾“å‡ºçš„æ•°å­—è¢«æˆªæ–­äº†ã€‚ä½†æ˜¯ï¼Œæµ®ç‚¹æ•°çš„æ¯”è¾ƒå¯èƒ½ä¸ä¼šç»™å‡ºé¢„æœŸçš„ç»“æœã€‚å¯¹è¿™äº›å€¼æ‰§è¡Œæ•°å­¦è¿ç®—å°†å¯¼è‡´èˆå…¥è¯¯å·®å˜å¤§

## å¸ƒå°”å€¼

å¦‚æœæ‚¨å¸Œæœ› std::cout æ‰“å°â€œtrueâ€æˆ–â€œfalseâ€è€Œä¸æ˜¯ 0 æˆ– 1ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ std::boolalphaã€‚è¿™æ˜¯ä¸€ä¸ªä¾‹å­ï¼š

```cpp
#include <iostream>

int main()
{
    std::cout << true << '\n';
    std::cout << false << '\n';

    std::cout << std::boolalpha; // print bools as true or false

    std::cout << true << '\n';
    std::cout << false << '\n';
    return 0;
}
```

æ‚¨å¯ä»¥ä½¿ç”¨ std::noboolalpha å°†å…¶å…³é—­

æ‚¨ä¸èƒ½ä½¿ç”¨é™¤ 0 1 å¤–çš„æ•´æ•°åˆå§‹åŒ–å¸ƒå°”å€¼ï¼š

```cpp
#include <iostream>

int main()
{
	bool b{ 4 }; // error: narrowing conversions disallowed
	std::cout << b;

	return 0;
}
```

ä½†æ˜¯ï¼Œåœ¨ä»»ä½•å¯ä»¥å°†æ•´æ•°è½¬æ¢ä¸ºå¸ƒå°”å€¼çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œæ•´æ•° 0 å°†è½¬æ¢ä¸º falseï¼Œè€Œä»»ä½•å…¶ä»–æ•´æ•°å°†è½¬æ¢ä¸º true

äº‹å®è¯æ˜ï¼Œstd::cin åªæ¥å—å¸ƒå°”å˜é‡çš„ä¸¤ä¸ªè¾“å…¥ï¼š0 å’Œ 1ï¼ˆä¸æ˜¯ true æˆ– falseï¼‰ã€‚ä»»ä½•å…¶ä»–è¾“å…¥éƒ½ä¼šå¯¼è‡´ std::cin æ— å£°åœ°å¤±è´¥ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå› ä¸ºæˆ‘ä»¬è¾“å…¥äº† trueï¼Œæ‰€ä»¥ std::cin é»˜é»˜åœ°å¤±è´¥äº†ã€‚å¤±è´¥çš„è¾“å…¥ä¹Ÿä¼šå°†å˜é‡æ¸…é›¶ï¼Œå› æ­¤ b ä¹Ÿè¢«èµ‹å€¼ falseã€‚å› æ­¤ï¼Œå½“ std::cout æ‰“å° b çš„å€¼æ—¶ï¼Œå®ƒæ‰“å° 0

è¦å…è®¸ std::cin æ¥å—â€œfalseâ€å’Œâ€œtrueâ€ä½œä¸ºè¾“å…¥ï¼Œå¿…é¡»å¯ç”¨ std::boolalpha é€‰é¡¹ï¼š

```cpp
#include <iostream>

int main()
{
	bool b{};
	std::cout << "Enter a boolean value: ";

	// Allow the user to enter 'true' or 'false' for boolean values
	// This is case-sensitive, so True or TRUE will not work
	std::cin >> std::boolalpha;
	std::cin >> b;

	std::cout << "You entered: " << b << '\n';

	return 0;
}
```

ä½†æ˜¯ï¼Œå½“å¯ç”¨ std::boolalpha æ—¶ï¼Œâ€œ0â€å’Œâ€œ1â€å°†ä¸å†è¢«è§†ä¸ºå¸ƒå°”å€¼

## Chars

char æ•°æ®ç±»å‹æ—¨åœ¨ä¿å­˜å•ä¸ªå­—ç¬¦ã€‚å­—ç¬¦å¯ä»¥æ˜¯å•ä¸ªå­—æ¯ã€æ•°å­—ã€ç¬¦å·æˆ–ç©ºæ ¼

char æ•°æ®ç±»å‹æ˜¯æ•´æ•°ç±»å‹ï¼Œè¿™æ„å‘³ç€åŸºç¡€å€¼å­˜å‚¨ä¸ºæ•´æ•°ã€‚ç±»ä¼¼äºå¸ƒå°”å€¼ 0 è¢«è§£é‡Šä¸º false è€Œéé›¶è¢«è§£é‡Šä¸º true çš„æ–¹å¼ï¼Œchar å˜é‡å­˜å‚¨çš„æ•´æ•°è¢«è§£é‡Šä¸º ASCII å­—ç¬¦

Char ç”± C++ å®šä¹‰ä¸ºå¤§å°å§‹ç»ˆä¸º 1 ä¸ªå­—èŠ‚ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œchar å¯ä»¥æ˜¯æœ‰ç¬¦å·çš„æˆ–æ— ç¬¦å·çš„ï¼ˆå°½ç®¡å®ƒé€šå¸¸æ˜¯æœ‰ç¬¦å·çš„ï¼‰ã€‚å¦‚æœæ‚¨ä½¿ç”¨ chars æ¥ä¿å­˜ ASCII å­—ç¬¦ï¼Œåˆ™ä¸éœ€è¦æŒ‡å®šç¬¦å·ï¼ˆå› ä¸ºæœ‰ç¬¦å·å’Œæ— ç¬¦å·å­—ç¬¦éƒ½å¯ä»¥ä¿å­˜ 0 åˆ° 127 ä¹‹é—´çš„å€¼ï¼‰

å¦‚æœæ‚¨ä½¿ç”¨ char æ¥ä¿å­˜å°æ•´æ•°ï¼ˆé™¤éæ‚¨æ˜ç¡®ä¼˜åŒ–ç©ºé—´ï¼Œå¦åˆ™æ‚¨ä¸åº”è¯¥è¿™æ ·åšï¼‰ï¼Œæ‚¨åº”è¯¥å§‹ç»ˆæŒ‡å®šå®ƒæ˜¯æœ‰ç¬¦å·çš„è¿˜æ˜¯æ— ç¬¦å·çš„ã€‚ signed char å¯ä»¥ä¿å­˜ -128 åˆ° 127 ä¹‹é—´çš„æ•°å­—ã€‚unsigned char å¯ä»¥ä¿å­˜ 0 åˆ° 255 ä¹‹é—´çš„æ•°å­—

**å°†å•ä¸ªå­—ç¬¦æ”¾åœ¨å•å¼•å·ä¸­ï¼ˆ e.g. `'t'` or `'\n'`, not `"t"` or `"\n"`ï¼‰è¿™æœ‰åŠ©äºç¼–è¯‘å™¨æ›´æœ‰æ•ˆåœ°è¿›è¡Œä¼˜åŒ–**

å‡ºäºå‘åå…¼å®¹æ€§çš„åŸå› ï¼Œè®¸å¤š C++ ç¼–è¯‘å™¨æ”¯æŒå¤šå­—ç¬¦æ–‡å­—ï¼Œå³åŒ…å«å¤šä¸ªå­—ç¬¦ï¼ˆä¾‹å¦‚â€œ56â€ï¼‰çš„å­—ç¬¦æ–‡å­—ã€‚å¦‚æœæ”¯æŒï¼Œå®ƒä»¬å…·æœ‰å®ç°å®šä¹‰çš„å€¼ï¼ˆæ„å‘³ç€å®ƒå› ç¼–è¯‘å™¨è€Œå¼‚ï¼‰ã€‚å› ä¸ºå®ƒä»¬ä¸æ˜¯ C++ æ ‡å‡†çš„ä¸€éƒ¨åˆ†ï¼Œè€Œä¸”å®ƒä»¬çš„å€¼ä¹Ÿæ²¡æœ‰ä¸¥æ ¼å®šä¹‰ï¼Œæ‰€ä»¥åº”è¯¥é¿å…ä½¿ç”¨å¤šå­—ç¬¦æ–‡å­—

ASCII ä¹‹å¤–æœ€è‘—åçš„æ˜ å°„æ˜¯ Unicode æ ‡å‡†ï¼Œå®ƒå°†è¶…è¿‡ 144,000 ä¸ªæ•´æ•°æ˜ å°„åˆ°è®¸å¤šä¸åŒè¯­è¨€çš„å­—ç¬¦ã€‚ç”±äº Unicode åŒ…å«å¦‚æ­¤å¤šçš„ä»£ç ç‚¹ï¼Œå› æ­¤å•ä¸ª Unicode ä»£ç ç‚¹éœ€è¦ 32 ä½æ¥è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ï¼ˆç§°ä¸º UTF-32ï¼‰ã€‚ä½†æ˜¯ï¼ŒUnicode å­—ç¬¦ä¹Ÿå¯ä»¥ä½¿ç”¨å¤šä¸ª 16 ä½æˆ– 8 ä½å­—ç¬¦ï¼ˆåˆ†åˆ«ç§°ä¸º UTF-16 å’Œ UTF-8ï¼‰è¿›è¡Œç¼–ç 

char16\_t å’Œ char32\_t æ·»åŠ åˆ° C++11 ä»¥æä¾›å¯¹ 16 ä½å’Œ 32 ä½ Unicode å­—ç¬¦çš„æ˜ç¡®æ”¯æŒã€‚ C++20 ä¸­æ·»åŠ äº† char8\_t

æ‚¨ä¸éœ€è¦ä½¿ç”¨ char8\_tã€char16\_t æˆ– char32\_tï¼Œé™¤éæ‚¨è®¡åˆ’è®©æ‚¨çš„ç¨‹åºä¸ Unicode å…¼å®¹

åŒæ—¶ï¼Œåœ¨å¤„ç†å­—ç¬¦ï¼ˆå’Œå­—ç¬¦ä¸²ï¼‰æ—¶ï¼Œæ‚¨åº”è¯¥åªä½¿ç”¨ ASCII å­—ç¬¦ã€‚ä½¿ç”¨æ¥è‡ªå…¶ä»–å­—ç¬¦é›†çš„å­—ç¬¦å¯èƒ½ä¼šå¯¼è‡´æ‚¨çš„å­—ç¬¦æ˜¾ç¤ºä¸æ­£ç¡®

## å¸¸é‡å’Œç¬¦å·å¸¸é‡

### const variables

Const å˜é‡å¿…é¡»åœ¨å®šä¹‰å®ƒä»¬æ—¶è¿›è¡Œåˆå§‹åŒ–ï¼Œç„¶åä¸èƒ½é€šè¿‡èµ‹å€¼æ›´æ”¹è¯¥å€¼

Const å˜é‡å¯ä»¥ä»å…¶ä»–å˜é‡ï¼ˆåŒ…æ‹¬éå¸¸é‡å˜é‡ï¼‰åˆå§‹åŒ–

å‘½åæ—¶ä»¥ â€œkâ€ å¼€å¤´, å¤§å°å†™æ··åˆ,ä¾‹å¦‚ï¼š

```
const int kDaysInAWeek = 7;
```

### ç¬¦å·å¸¸é‡

ç¬¦å·å¸¸é‡æŒ‡çš„æ˜¯**è¢«èµ‹äºˆå¸¸é‡å€¼çš„åç§°**ã€‚`const variables` æ˜¯ä¸€ç§ç¬¦å·å¸¸é‡ï¼Œå› ä¸ºå˜é‡æœ‰ä¸€ä¸ªåç§°ï¼ˆå®ƒçš„æ ‡è¯†ç¬¦ï¼‰å’Œä¸€ä¸ªå¸¸é‡å€¼

```cpp
#include <iostream>
#define MAX_STUDENTS_PER_CLASS 30

int main()
{
    std::cout << "The class has " << MAX_STUDENTS_PER_CLASS << " students.\n";

    return 0;
}
```

ç¼–è¯‘æ­¤ç¨‹åºæ—¶ï¼Œé¢„å¤„ç†å™¨ä¼šå°† MAX\_STUDENTS\_PER\_CLASS æ›¿æ¢ä¸ºå­—é¢å€¼ 30ï¼Œç„¶åç¼–è¯‘å™¨ä¼šå°†å…¶ç¼–è¯‘ä¸ºæ‚¨çš„å¯æ‰§è¡Œæ–‡ä»¶

å› ä¸ºç±»å¯¹è±¡å®æœ‰ä¸€ä¸ªåå­—ï¼Œå¹¶ä¸”æ›¿æ¢æ–‡æœ¬æ˜¯ä¸€ä¸ªå¸¸é‡å€¼ï¼Œæ‰€ä»¥å¸¦æœ‰æ›¿æ¢æ–‡æœ¬çš„ç±»å¯¹è±¡å®ä¹Ÿæ˜¯ç¬¦å·å¸¸é‡

### å¯¹äºç¬¦å·å¸¸é‡ï¼Œæ›´å–œæ¬¢å¸¸é‡å˜é‡è€Œä¸æ˜¯ç±»å¯¹è±¡å®

é¦–å…ˆï¼Œå› ä¸ºå®æ˜¯ç”±é¢„å¤„ç†å™¨è§£æçš„ï¼Œæ‰€æœ‰å‡ºç°çš„å®éƒ½åœ¨ç¼–è¯‘ä¹‹å‰è¢«å®šä¹‰çš„å€¼æ›¿æ¢ã€‚å¦‚æœæ‚¨æ­£åœ¨è°ƒè¯•ä»£ç ï¼Œæ‚¨å°†çœ‹ä¸åˆ°å®é™…å€¼ï¼ˆä¾‹å¦‚ 30ï¼‰â€”â€”æ‚¨åªä¼šçœ‹åˆ°ç¬¦å·å¸¸é‡çš„åç§°ï¼ˆä¾‹å¦‚ MAX\_STUDENTS\_PER\_CLASSï¼‰ã€‚å› ä¸ºè¿™äº›#defined å€¼ä¸æ˜¯å˜é‡ï¼Œæ‰€ä»¥æ‚¨æ— æ³•åœ¨è°ƒè¯•å™¨ä¸­æ·»åŠ ç›‘è§†æ¥æŸ¥çœ‹å®ƒä»¬çš„å€¼ã€‚å¦‚æœæ‚¨æƒ³çŸ¥é“ MAX\_STUDENTS\_PER\_CLASS è§£æä¸ºä»€ä¹ˆå€¼ï¼Œæ‚¨å¿…é¡»æ‰¾åˆ° MAX\_STUDENTS\_PER\_CLASS çš„å®šä¹‰ï¼ˆå¯èƒ½åœ¨ä¸åŒçš„æ–‡ä»¶ä¸­ï¼‰ã€‚è¿™ä¼šä½¿æ‚¨çš„ç¨‹åºæ›´éš¾è°ƒè¯•

å…¶æ¬¡ï¼Œå®å¯èƒ½ä¸æ™®é€šä»£ç æœ‰å‘½åå†²çª

ç¬¬ä¸‰ï¼Œå®ä¸éµå¾ªæ­£å¸¸çš„ä½œç”¨åŸŸè§„åˆ™ï¼Œè¿™æ„å‘³ç€åœ¨æå°‘æ•°æƒ…å†µä¸‹ï¼Œåœ¨ç¨‹åºçš„ä¸€éƒ¨åˆ†ä¸­å®šä¹‰çš„å®å¯èƒ½ä¼šä¸åœ¨ç¨‹åºçš„å¦ä¸€éƒ¨åˆ†ä¸­ç¼–å†™çš„ä»£ç å‘ç”Ÿå†²çªï¼Œè€Œå®ƒä¸åº”è¯¥ä¸ä¹‹äº¤äº’

## ç¼–è¯‘æ—¶å¸¸é‡ã€å¸¸é‡è¡¨è¾¾å¼å’Œ constexpr

### Constant expressions

å¸¸é‡è¡¨è¾¾å¼æ˜¯å¯ä»¥åœ¨ç¼–è¯‘æ—¶ç”±ç¼–è¯‘å™¨æ±‚å€¼çš„è¡¨è¾¾å¼ã€‚è¦æˆä¸ºå¸¸é‡è¡¨è¾¾å¼ï¼Œè¡¨è¾¾å¼ä¸­çš„æ‰€æœ‰å€¼å¿…é¡»åœ¨ç¼–è¯‘æ—¶å·²çŸ¥ï¼ˆå¹¶ä¸”æ‰€æœ‰è°ƒç”¨çš„è¿ç®—ç¬¦å’Œå‡½æ•°å¿…é¡»æ”¯æŒç¼–è¯‘æ—¶æ±‚å€¼ï¼‰

åœ¨ç¼–è¯‘æ—¶å¯¹å¸¸é‡è¡¨è¾¾å¼æ±‚å€¼ä¼šä½¿æˆ‘ä»¬çš„ç¼–è¯‘æ—¶é—´å˜é•¿ï¼ˆå› ä¸ºç¼–è¯‘å™¨å¿…é¡»åšæ›´å¤šçš„å·¥ä½œï¼‰ï¼Œä½†è¿™æ ·çš„è¡¨è¾¾å¼åªéœ€è¦æ±‚å€¼ä¸€æ¬¡ï¼ˆè€Œä¸æ˜¯æ¯æ¬¡ç¨‹åºè¿è¡Œæ—¶ï¼‰ã€‚ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶é€Ÿåº¦æ›´å¿«ï¼Œä½¿ç”¨çš„å†…å­˜æ›´å°‘

### Compile-time constants

ç¼–è¯‘æ—¶å¸¸é‡æ˜¯å…¶å€¼åœ¨ç¼–è¯‘æ—¶å·²çŸ¥çš„å¸¸é‡ã€‚æ–‡å­—ï¼ˆä¾‹å¦‚â€œ1â€ã€â€œ2.3â€å’Œâ€œHello, world!â€ï¼‰æ˜¯ä¸€ç§ç¼–è¯‘æ—¶å¸¸é‡

Const å˜é‡å¯èƒ½æ˜¯ä¹Ÿå¯èƒ½ä¸æ˜¯ç¼–è¯‘æ—¶å¸¸é‡

### Compile-time const

å¦‚æœ const å˜é‡çš„åˆå§‹å€¼è®¾å®šé¡¹æ˜¯å¸¸é‡è¡¨è¾¾å¼ï¼Œåˆ™å®ƒæ˜¯ç¼–è¯‘æ—¶å¸¸é‡

```cpp
#include <iostream>

int main()
{
	const int x { 3 };  // x is a compile-time const
	const int y { 4 };  // y is a compile-time const

	const int z { x + y }; // x + y is a compile-time expression

	std::cout << z << '\n';

	return 0;
}
```

å› ä¸º x å’Œ y çš„åˆå§‹åŒ–å€¼æ˜¯å¸¸é‡è¡¨è¾¾å¼ï¼Œæ‰€ä»¥ x å’Œ y æ˜¯ç¼–è¯‘æ—¶å¸¸é‡ã€‚è¿™æ„å‘³ç€ x + y ä¹Ÿæ˜¯å¸¸é‡è¡¨è¾¾å¼ã€‚æ‰€ä»¥å½“ç¼–è¯‘å™¨ç¼–è¯‘è¿™ä¸ªç¨‹åºæ—¶ï¼Œå®ƒå¯ä»¥è®¡ç®— x + y çš„å€¼ï¼Œå¹¶å°†å¸¸é‡è¡¨è¾¾å¼æ›¿æ¢ä¸ºç»“æœæ–‡å­— 7

### Runtime const

ä»»ä½•ä½¿ç”¨éå¸¸é‡è¡¨è¾¾å¼åˆå§‹åŒ–çš„ const å˜é‡éƒ½æ˜¯è¿è¡Œæ—¶å¸¸é‡ã€‚è¿è¡Œæ—¶å¸¸é‡æ˜¯å…¶åˆå§‹åŒ–å€¼ç›´åˆ°è¿è¡Œæ—¶æ‰çŸ¥é“çš„å¸¸é‡

```cpp
#include <iostream>

int getNumber()
{
    std::cout << "Enter a number: ";
    int y{};
    std::cin >> y;

    return y;
}

int main()
{
    const int x{ 3 };           // x is a compile time constant

    const int y{ getNumber() }; // y is a runtime constant

    const int z{ x + y };       // x + y is a runtime expression
    std::cout << z << '\n';     // this is also a runtime expression

    return 0;
}
```

å³ä½¿ y æ˜¯å¸¸é‡ï¼Œåˆå§‹åŒ–å€¼ï¼ˆgetNumber() çš„è¿”å›å€¼ï¼‰ç›´åˆ°è¿è¡Œæ—¶æ‰çŸ¥é“ã€‚å› æ­¤ï¼Œy æ˜¯è¿è¡Œæ—¶å¸¸é‡ï¼Œè€Œä¸æ˜¯ç¼–è¯‘æ—¶å¸¸é‡ã€‚å› æ­¤ï¼Œè¡¨è¾¾å¼ x + y æ˜¯ä¸€ä¸ªè¿è¡Œæ—¶è¡¨è¾¾å¼

### constexpr å…³é”®å­—

å½“ä½ å£°æ˜ä¸€ä¸ª const å˜é‡æ—¶ï¼Œç¼–è¯‘å™¨ä¼šéšå¼åœ°è·Ÿè¸ªå®ƒæ˜¯è¿è¡Œæ—¶å¸¸é‡è¿˜æ˜¯ç¼–è¯‘æ—¶å¸¸é‡ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œé™¤äº†ä¼˜åŒ–ç›®çš„ä¹‹å¤–ï¼Œè¿™æ— å…³ç´§è¦ï¼Œä½†æœ‰ä¸€äº›å¥‡æ€ªçš„æƒ…å†µï¼ŒC++ éœ€è¦ç¼–è¯‘æ—¶å¸¸é‡è€Œä¸æ˜¯è¿è¡Œæ—¶å¸¸é‡

å› ä¸ºç¼–è¯‘æ—¶å¸¸é‡é€šå¸¸å…è®¸æ›´å¥½çš„ä¼˜åŒ–ï¼ˆå¹¶ä¸”å‡ ä¹æ²¡æœ‰ç¼ºç‚¹ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬é€šå¸¸å¸Œæœ›å°½å¯èƒ½ä½¿ç”¨ç¼–è¯‘æ—¶å¸¸é‡

æˆ‘ä»¬å¯ä»¥å¯»æ±‚ç¼–è¯‘å™¨çš„å¸®åŠ©ï¼Œä»¥ç¡®ä¿æˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªæˆ‘ä»¬æœŸæœ›çš„ç¼–è¯‘æ—¶å¸¸é‡ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬åœ¨å˜é‡å£°æ˜ä¸­ä½¿ç”¨ constexpr å…³é”®å­—è€Œä¸æ˜¯ constã€‚ constexprï¼ˆâ€œå¸¸é‡è¡¨è¾¾å¼â€çš„ç¼©å†™ï¼‰å˜é‡åªèƒ½æ˜¯ç¼–è¯‘æ—¶å¸¸é‡ã€‚å¦‚æœ constexpr å˜é‡çš„åˆå§‹åŒ–å€¼ä¸æ˜¯å¸¸é‡è¡¨è¾¾å¼ï¼Œç¼–è¯‘å™¨ä¼šå‡ºé”™

```cpp
#include <iostream>

int five()
{
    return 5;
}

int main()
{
    constexpr double gravity { 9.8 }; // ok: 9.8 is a constant expression
    constexpr int sum { 4 + 5 };      // ok: 4 + 5 is a constant expression
    constexpr int something { sum };  // ok: sum is a constant expression

    std::cout << "Enter your age: ";
    int age{};
    std::cin >> age;

    constexpr int myAge { age };      // compile error: age is not a constant expression
    constexpr int f { five() };       // compile error: return value of five() is not a constant expression

    return 0;
}
```

ä»»ä½•åœ¨åˆå§‹åŒ–åä¸åº”ä¿®æ”¹ä¸”å…¶åˆå§‹å€¼è®¾å®šé¡¹åœ¨ç¼–è¯‘æ—¶å·²çŸ¥çš„å˜é‡éƒ½åº”å£°æ˜ä¸º `constexpr`

ä»»ä½•åœ¨åˆå§‹åŒ–åä¸åº”ä¿®æ”¹ä¸”å…¶åˆå§‹å€¼è®¾å®šé¡¹åœ¨ç¼–è¯‘æ—¶æœªçŸ¥çš„å˜é‡éƒ½åº”å£°æ˜ä¸º `const`

## Literals

æ–‡å­—æ˜¯ç›´æ¥æ’å…¥ä»£ç ä¸­çš„æœªå‘½åå€¼ã€‚ä¾‹å¦‚ï¼š

```cpp
return 5;                   // 5 is an integer literal
bool myNameIsAlex { true }; // true is a boolean literal
std::cout << 3.4;           // 3.4 is a double literal
```

å¦‚å¯¹è±¡æœ‰ç±»å‹ä¸€æ ·ï¼Œæ‰€æœ‰æ–‡å­—éƒ½æœ‰ç±»å‹ã€‚æ–‡å­—çš„ç±»å‹æ˜¯ä»æ–‡å­—çš„å€¼æ¨å¯¼å‡ºæ¥çš„

## åè¿›åˆ¶ã€äºŒè¿›åˆ¶ã€åå…­è¿›åˆ¶å’Œå…«è¿›åˆ¶

### äºŒè¿›åˆ¶æ–‡å­—å’Œæ•°å­—åˆ†éš”ç¬¦

åœ¨ C++14 ä¹‹å‰ï¼Œä¸æ”¯æŒäºŒè¿›åˆ¶æ–‡å­—ã€‚ç„¶è€Œï¼Œåå…­è¿›åˆ¶æ–‡å­—ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªæœ‰ç”¨çš„è§£å†³æ–¹æ³•ï¼ˆæ‚¨å¯èƒ½ä»ä¼šåœ¨ç°æœ‰ä»£ç åº“ä¸­çœ‹åˆ°ï¼‰ï¼š

```cpp
#include <iostream>

int main()
{
    int bin{};    // assume 16-bit ints
    bin = 0x0001; // assign binary 0000 0000 0000 0001 to the variable
    bin = 0x0002; // assign binary 0000 0000 0000 0010 to the variable
    bin = 0x0004; // assign binary 0000 0000 0000 0100 to the variable
    bin = 0x0008; // assign binary 0000 0000 0000 1000 to the variable
    bin = 0x0010; // assign binary 0000 0000 0001 0000 to the variable
    bin = 0x0020; // assign binary 0000 0000 0010 0000 to the variable
    bin = 0x0040; // assign binary 0000 0000 0100 0000 to the variable
    bin = 0x0080; // assign binary 0000 0000 1000 0000 to the variable
    bin = 0x00FF; // assign binary 0000 0000 1111 1111 to the variable
    bin = 0x00B3; // assign binary 0000 0000 1011 0011 to the variable
    bin = 0xF770; // assign binary 1111 0111 0111 0000 to the variable

    return 0;
}
```

åœ¨ C++14 ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨ 0b å‰ç¼€æ¥ä½¿ç”¨äºŒè¿›åˆ¶æ–‡å­—ï¼š

```cpp
#include <iostream>

int main()
{
    int bin{};        // assume 16-bit ints
    bin = 0b1;        // assign binary 0000 0000 0000 0001 to the variable
    bin = 0b11;       // assign binary 0000 0000 0000 0011 to the variable
    bin = 0b1010;     // assign binary 0000 0000 0000 1010 to the variable
    bin = 0b11110000; // assign binary 0000 0000 1111 0000 to the variable

    return 0;
}
```

ç”±äºé•¿æ–‡æœ¬å¯èƒ½éš¾ä»¥é˜…è¯»ï¼ŒC++14 è¿˜æ·»åŠ äº†ä½¿ç”¨å¼•å· (â€˜) ä½œä¸ºæ•°å­—åˆ†éš”ç¬¦çš„åŠŸèƒ½ï¼ˆåˆ†éš”ç¬¦ä¸èƒ½å‡ºç°åœ¨å€¼çš„ç¬¬ä¸€ä½æ•°å­—ä¹‹å‰ï¼‰ï¼ˆæ•°å­—åˆ†éš”ç¬¦çº¯ç²¹æ˜¯è§†è§‰ä¸Šçš„ï¼Œä¸ä¼šä»¥ä»»ä½•æ–¹å¼å½±å“å­—é¢å€¼ï¼‰

```cpp
#include <iostream>

int main()
{
    int bin { 0b1011'0010 };  // assign binary 1011 0010 to the variable
    long value { 2'132'673'462 }; // much easier to read than 2132673462

    return 0;
}
```

### ä»¥åè¿›åˆ¶ã€å…«è¿›åˆ¶æˆ–åå…­è¿›åˆ¶è¾“å‡ºå€¼

é»˜è®¤æƒ…å†µä¸‹ï¼ŒC++ ä»¥åè¿›åˆ¶å½¢å¼è¾“å‡ºå€¼ã€‚ä½†æ˜¯ï¼Œæ‚¨å¯ä»¥é€šè¿‡ä½¿ç”¨ std::decã€std::oct å’Œ std::hex I/O æ“çºµå™¨æ›´æ”¹è¾“å‡ºæ ¼å¼ï¼š

```cpp
#include <iostream>

int main()
{
    int x { 12 };
    std::cout << x << '\n'; // decimal (by default)
    std::cout << std::hex << x << '\n'; // hexadecimal
    std::cout << x << '\n'; // now hexadecimal
    std::cout << std::oct << x << '\n'; // octal
    std::cout << std::dec << x << '\n'; // return to decimal
    std::cout << x << '\n'; // decimal

    return 0;
}
```

### ä»¥äºŒè¿›åˆ¶è¾“å‡ºå€¼

ä»¥äºŒè¿›åˆ¶å½¢å¼è¾“å‡ºå€¼æœ‰ç‚¹å›°éš¾ï¼Œå› ä¸º std::cout æ²¡æœ‰å†…ç½®æ­¤åŠŸèƒ½ã€‚å¹¸è¿çš„æ˜¯ï¼ŒC++ æ ‡å‡†åº“åŒ…å«ä¸€ä¸ªåä¸º std::bitset çš„ç±»å‹ï¼Œå®ƒå°†ä¸ºæˆ‘ä»¬å®Œæˆæ­¤æ“ä½œï¼ˆåœ¨ `<bitset>` æ ‡å¤´ä¸­ï¼‰ã€‚è¦ä½¿ç”¨ std::bitsetï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ª std::bitset å˜é‡å¹¶å‘Šè¯‰ std::bitset æˆ‘ä»¬è¦å­˜å‚¨å¤šå°‘ä½ã€‚ä½æ•°å¿…é¡»æ˜¯ç¼–è¯‘æ—¶å¸¸é‡ã€‚ std::bitset å¯ä»¥ç”¨æ— ç¬¦å·æ•´æ•°å€¼ï¼ˆä»»ä½•æ ¼å¼ï¼ŒåŒ…æ‹¬åè¿›åˆ¶ã€å…«è¿›åˆ¶ã€åå…­è¿›åˆ¶æˆ–äºŒè¿›åˆ¶ï¼‰åˆå§‹åŒ–

```cpp
#include <bitset> // for std::bitset
#include <iostream>

int main()
{
	// std::bitset<8> means we want to store 8 bits
	std::bitset<8> bin1{ 0b1100'0101 }; // binary literal for binary 1100 0101
	std::bitset<8> bin2{ 0xC5 }; // hexadecimal literal for binary 1100 0101

	std::cout << bin1 << '\n' << bin2 << '\n';
	std::cout << std::bitset<4>{ 0b1010 } << '\n'; // create a temporary std::bitset and print it

	return 0;
}
```

## std::string

### ä½¿ç”¨ std::getline() è¾“å…¥æ–‡æœ¬

äº‹å®è¯æ˜ï¼Œå½“ä½¿ç”¨ operator>> ä» std::cin ä¸­æå–å­—ç¬¦ä¸²æ—¶ï¼Œoperator>> åªè¿”å›å®ƒé‡åˆ°çš„ç¬¬ä¸€ä¸ªç©ºæ ¼ä¹‹å‰çš„å­—ç¬¦ã€‚ä»»ä½•å…¶ä»–å­—ç¬¦éƒ½ç•™åœ¨ std::cin ä¸­ï¼Œç­‰å¾…ä¸‹ä¸€æ¬¡æå–

è¦å°†æ•´è¡Œè¾“å…¥è¯»å…¥å­—ç¬¦ä¸²ï¼Œæœ€å¥½æ”¹ç”¨ `std::getline()` å‡½æ•°ã€‚ std::getline() éœ€è¦ä¸¤ä¸ªå‚æ•°ï¼šç¬¬ä¸€ä¸ªæ˜¯ std::cinï¼Œç¬¬äºŒä¸ªæ˜¯æ‚¨çš„å­—ç¬¦ä¸²å˜é‡

```cpp
#include <string> // For std::string and std::getline
#include <iostream>

int main()
{
    std::cout << "Enter your full name: ";
    std::string name{};
    std::getline(std::cin >> std::ws, name); // read a full line of text into name

    std::cout << "Enter your age: ";
    std::string age{};
    std::getline(std::cin >> std::ws, age); // read a full line of text into age

    std::cout << "Your name is " << name << " and your age is " << age << '\n';

    return 0;
}
```

`std::ws` è¾“å…¥æ“çºµå™¨å‘Šè¯‰ std::cin åœ¨æå–ä¹‹å‰**å¿½ç•¥ä»»ä½•å‰å¯¼ç©ºæ ¼**ã€‚å‰å¯¼ç©ºç™½æ˜¯å‡ºç°åœ¨å­—ç¬¦ä¸²å¼€å¤´çš„ä»»ä½•ç©ºç™½å­—ç¬¦ï¼ˆç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢è¡Œç¬¦ï¼‰

å¦‚æœä½¿ç”¨ `std::getline()` è¯»å–å­—ç¬¦ä¸²ï¼Œè¯·ä½¿ç”¨ `std::cin >> std::ws` è¾“å…¥æ“çºµå™¨å¿½ç•¥å‰å¯¼ç©ºæ ¼

å°†æå–è¿ç®—ç¬¦ (>>) ä¸ std::cin ä¸€èµ·ä½¿ç”¨ä¼šå¿½ç•¥å‰å¯¼ç©ºæ ¼

std::getline() ä¸ä¼šå¿½ç•¥å‰å¯¼ç©ºæ ¼ï¼Œé™¤éæ‚¨ä½¿ç”¨è¾“å…¥æ“çºµå™¨ std::ws

### å­—ç¬¦ä¸²é•¿åº¦

å¦‚æœæˆ‘ä»¬æƒ³çŸ¥é“ std::string ä¸­æœ‰å¤šå°‘ä¸ªå­—ç¬¦ï¼Œæˆ‘ä»¬å¯ä»¥å‘ std::string å¯¹è±¡è¯¢é—®å®ƒçš„é•¿åº¦ã€‚æ³¨æ„ std::string::length() è¿”å›ä¸€ä¸ªæ— ç¬¦å·æ•´æ•°å€¼ï¼ˆå¾ˆå¯èƒ½æ˜¯ size\_t ç±»å‹ï¼‰ã€‚å¦‚æœä½ æƒ³å°†é•¿åº¦åˆ†é…ç»™ä¸€ä¸ª int å˜é‡ï¼Œä½ åº”è¯¥å¯¹å…¶è¿›è¡Œ static\_cast ä»¥é¿å…ç¼–è¯‘å™¨å…³äºæœ‰ç¬¦å·/æ— ç¬¦å·è½¬æ¢çš„è­¦å‘Šï¼š

```cpp
int length { static_cast<int>(name.length()) };
```

### std::string çš„åˆå§‹åŒ–å’Œå¤åˆ¶å¼€é”€å¾ˆå¤§

æ¯å½“åˆå§‹åŒ– std::string æ—¶ï¼Œéƒ½ä¼šç”Ÿæˆç”¨äºåˆå§‹åŒ–å®ƒçš„å­—ç¬¦ä¸²çš„å‰¯æœ¬ã€‚æ¯å½“ std::string æŒ‰å€¼ä¼ é€’ç»™ std::string å‚æ•°æ—¶ï¼Œéƒ½ä¼šç”Ÿæˆå¦ä¸€ä¸ªå‰¯æœ¬ã€‚ä¸è¦æŒ‰å€¼ä¼ é€’ std::stringï¼Œå› ä¸ºç”Ÿæˆ std::string çš„å‰¯æœ¬å¼€é”€å¾ˆå¤§ã€‚æ›´å–œæ¬¢ std::string\_view å‚æ•°

### Literals for `std::string` & `std::string_view`

åŒå¼•å·å­—ç¬¦ä¸²æ–‡å­—ï¼ˆæ¯”å¦‚â€œHello, world!â€ï¼‰é»˜è®¤æ˜¯ C é£æ ¼çš„å­—ç¬¦ä¸²

æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨åŒå¼•å·å­—ç¬¦ä¸²æ–‡å­—åä½¿ç”¨ s åç¼€æ¥åˆ›å»ºç±»å‹ä¸º std::string çš„å­—ç¬¦ä¸²æ–‡å­—

```cpp
#include <iostream>
#include <string>      // for std::string
#include <string_view> // for std::string_view

int main()
{
    using namespace std::literals; // easiest way to access the s and sv suffixes

    std::cout << "foo\n";   // no suffix is a C-style string literal
    std::cout << "goo\n"s;  // s suffix is a std::string literal
    std::cout << "moo\n"sv; // sv suffix is a std::string_view literal

    return 0;
}
```

â€œsâ€åç¼€ä½äºå‘½åç©ºé—´ std::literals::string\_literals ä¸­ã€‚â€œsvâ€åç¼€ä½äºå‘½åç©ºé—´ std::literals::string\_view\_literals ä¸­ã€‚è®¿é—®æ–‡å­—åç¼€çš„æœ€ç®€å•æ–¹æ³•æ˜¯é€šè¿‡ä½¿ç”¨æŒ‡ä»¤ä½¿ç”¨å‘½åç©ºé—´ std::literalsã€‚è¿™æ˜¯å¯ä»¥ä½¿ç”¨æ•´ä¸ªå‘½åç©ºé—´çš„ä¾‹å¤–æƒ…å†µä¹‹ä¸€ï¼Œå› ä¸ºå…¶ä¸­å®šä¹‰çš„åç¼€ä¸å¤ªå¯èƒ½ä¸æ‚¨çš„ä»»ä½•ä»£ç å†²çª

ä½ å¯èƒ½ä¸éœ€è¦ç»å¸¸ä½¿ç”¨ std::string æ–‡å­—ï¼ˆå› ä¸ºç”¨ C é£æ ¼çš„å­—ç¬¦ä¸²æ–‡å­—åˆå§‹åŒ– std::string å¯¹è±¡å¾ˆå¥½ï¼‰ï¼Œä½†æˆ‘ä»¬ä¼šåœ¨ä»¥åçš„è¯¾ç¨‹ä¸­çœ‹åˆ°ä¸€äº›ä½¿ç”¨ std çš„æƒ…å†µ::string literals è€Œä¸æ˜¯ C é£æ ¼çš„ string literals ä½¿äº‹æƒ…å˜å¾—æ›´å®¹æ˜“

### Constexpr å­—ç¬¦ä¸²

å¦‚æœæ‚¨å°è¯•å®šä¹‰ä¸€ä¸ª constexpr std::stringï¼Œæ‚¨çš„ç¼–è¯‘å™¨å¯èƒ½ä¼šäº§ç”Ÿä¸€ä¸ªé”™è¯¯

```cpp
#include <iostream>
#include <string>

using namespace std::literals;

int main()
{
    constexpr std::string name{ "Alex"s }; // compile error

    std::cout << "My name is: " << name;

    return 0;
}
```

å‘ç”Ÿè¿™ç§æƒ…å†µæ˜¯å› ä¸º constexpr std::string åœ¨ C++17 æˆ–æ›´æ—©ç‰ˆæœ¬ä¸­ä¸å—æ”¯æŒï¼Œå¹¶ä¸”åœ¨ C++20 ä¸­ä»…æä¾›æœ€ä½é™åº¦çš„æ”¯æŒã€‚å¦‚æœæ‚¨éœ€è¦ constexpr å­—ç¬¦ä¸²ï¼Œè¯·æ”¹ç”¨ std::string\_view

## std::string\_view

### std::string\_view C++17

ä¸ºäº†è§£å†³ std::string åˆå§‹åŒ–ï¼ˆæˆ–å¤åˆ¶ï¼‰æˆæœ¬é«˜æ˜‚çš„é—®é¢˜ï¼ŒC++17 å¼•å…¥äº† std::string\_viewï¼ˆä½äº \<string\_view> æ ‡å¤´ä¸­ï¼‰ã€‚ std::string\_view æä¾›å¯¹ç°æœ‰å­—ç¬¦ä¸²ï¼ˆC é£æ ¼å­—ç¬¦ä¸²æ–‡å­—ã€std::string æˆ– char æ•°ç»„ï¼‰çš„åªè¯»è®¿é—®ï¼Œè€Œæ— éœ€åˆ¶ä½œå‰¯æœ¬

```cpp
#include <iostream>
#include <string_view>

void printSV(std::string_view str) // now a std::string_view
{
    std::cout << str << '\n';
}

int main()
{
    std::string_view s{ "Hello, world!" }; // now a std::string_view
    printSV(s);

    return 0;
}
```

å½“æˆ‘ä»¬ç”¨ C é£æ ¼çš„å­—ç¬¦ä¸²æ–‡å­—â€œHello, world!â€åˆå§‹åŒ– std::string\_view s æ—¶ï¼Œs æä¾›å¯¹â€œHello, world!â€çš„åªè¯»è®¿é—®ã€‚æ— éœ€å¤åˆ¶å­—ç¬¦ä¸²ã€‚å½“æˆ‘ä»¬å°† s ä¼ é€’ç»™ printSV() æ—¶ï¼Œå‚æ•° str ä» s åˆå§‹åŒ–ã€‚è¿™ä½¿æˆ‘ä»¬èƒ½å¤Ÿé€šè¿‡ str è®¿é—®â€œHello, world!â€ï¼Œä¸ç”¨å†æ¬¡å¤åˆ¶å­—ç¬¦ä¸²

å½“æ‚¨éœ€è¦åªè¯»å­—ç¬¦ä¸²æ—¶ï¼Œå°¤å…¶æ˜¯å¯¹äºå‡½æ•°å‚æ•°ï¼Œä¼˜å…ˆä½¿ç”¨ std::string\_view è€Œä¸æ˜¯ std::string

### constexpr std::string\_view

std::string\_view å®Œå…¨æ”¯æŒ constexprï¼š

```cpp
#include <iostream>
#include <string_view>

int main()
{
    constexpr std::string_view s{ "Hello, world!" };
    std::cout << s << '\n'; // s will be replaced with "Hello, world!" at compile-time

    return 0;
}
```

### std::string & std::string\_view

å¯ä»¥ä½¿ç”¨ std::string åˆå§‹å€¼è®¾å®šé¡¹åˆ›å»º std::string\_viewï¼Œå¹¶ä¸” std::string å°†éšå¼è½¬æ¢ä¸º std::string\_viewï¼š

```cpp
#include <iostream>
#include <string>
#include <string_view>

void printSV(std::string_view str)
{
    std::cout << str << '\n';
}

int main()
{
    std::string s{ "Hello, world" };
    std::string_view sv{ s }; // Initialize a std::string_view from a std::string
    std::cout << sv << '\n';

    printSV(s); // implicitly convert a std::string to std::string_view

    return 0;
}
```

å› ä¸º std::string å¤åˆ¶äº†å®ƒçš„åˆå§‹åŒ–å™¨ï¼ˆè¿™å¼€é”€å¾ˆå¤§ï¼‰ï¼ŒC++ ä¸å…è®¸å°† std::string\_view éšå¼è½¬æ¢ä¸º std::stringã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ std::string\_view åˆå§‹å€¼è®¾å®šé¡¹æ˜¾å¼åˆ›å»º std::stringï¼Œæˆ–è€…æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ static\_cast å°†ç°æœ‰çš„ std::string\_view è½¬æ¢ä¸º std::string

```cpp
#include <iostream>
#include <string>
#include <string_view>

void printString(std::string str)
{
    std::cout << str << '\n';
}

int main()
{
  std::string_view sv{ "balloon" };

  std::string str{ sv }; // okay, we can create std::string using std::string_view initializer

  // printString(sv);   // compile error: won't implicitly convert std::string_view to a std::string

  printString(static_cast<std::string>(sv)); // okay, we can explicitly cast a std::string_view to a std::string

  return 0;
}
```
